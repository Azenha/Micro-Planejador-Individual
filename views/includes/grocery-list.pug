//- grocery-list.pug

DOCTYPE(html)
html(lang='en')
  head
    meta(charset='UTF-8')
    meta(name='viewport' content='width=device-width, initial-scale=1.0')
    title Grocery Lists
    link(href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css' rel='stylesheet' integrity='sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN' crossorigin='anonymous')
    link(rel='stylesheet' href='https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css')
    link(rel='stylesheet' type='text/css' href='/css/style.css')

    script(src='https://unpkg.com/hyperscript.org@0.9.11')
    script(src='https://unpkg.com/htmx.org@1.9.6' integrity='sha384-FhXw7b6AlE/jyjlZH5iHa/tTe9EpJ1Y55RjcgPbjeWMskSxZt1v9qkxLJWNJaGni' crossorigin='anonymous')
  body
    nav(class='flex nav')
      i(class='bi bi-basket')
      h1(class='h1 mb-0') Grocery Lists

    div(class='container py-4 px-3 mx-auto')
      form(
        hx-post='/lists'
        hx-swap='beforeend'
        hx-target='#lists'
        class='mb-3 needs-validation'
        _='on htmx:afterRequest target.reset()'
      )
        input(
          placeholder='New List Name'
          type='text'
          name='name'
          id='name'
          class='form-control mb-3'
          required
        )
        button(type='submit' class='add-list btn btn-info') Create List
          i(class='bi bi-plus')

      h2 Grocery Lists
      table(class='table table-striped')
        thead
          tr
            th(class='table-secondary') List Name
            th(class='table-secondary')
            th(class='table-secondary')
        tbody(id='lists')
          each list in lists
            tr
              td #{list.name}
              td
                button(class='btn btn-primary' hx-get=`/lists/${list.id}/products`)
                  i(class='bi bi-pencil')
              td
                button(class='btn btn-danger' hx-delete=`/lists/${list.id}`)
                  i(class='bi bi-trash')

    script.
      document.addEventListener('DOMContentLoaded', function() {
        htmx.trigger(htmx.find('#lists'), 'refresh');
      });
